cmake_minimum_required(VERSION 3.10)
project(WepollDemo)

# Link wepoll and Winsock2
include_directories(${CMAKE_SOURCE_DIR}/wepoll)
link_directories(${CMAKE_SOURCE_DIR}/wepoll)

add_executable(wepoll_test main.c)
target_link_libraries(wepoll_test libwepoll.a ws2_32)

# Copy wepoll.dll to the executable's output directory (Debug/Release)
add_custom_command(TARGET wepoll_test POST_BUILD
    COMMAND ${CMAKE_COMMAND} -E copy
        "${CMAKE_SOURCE_DIR}/wepoll/wepoll.dll"
        "$<TARGET_FILE_DIR:wepoll_test>"
    COMMENT "Copying wepoll.dll to executable directory"
)
